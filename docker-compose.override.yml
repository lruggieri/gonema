version: '3.0'

# DEVELOPMENT

services:

  gonemapi:
    ports:
      - 4242:8080 # callable from outside container network using port 4242
    hostname: gonemapi
    volumes:
      - ./pkg:/visualResourceServer/pkg
      - ./cmd/visualResourceServer:/visualResourceServer/cmd/visualResourceServer
      - ./configs:/visualResourceServer/configs
    environment:
      - GONEMAES_HOST=http://gonemaes


  gonemaweb:
    ports:
      - 8080:8080
    hostname: gonemaweb
    volumes:
      - ./pkg:/web/pkg
      - ./website:/web/website
      - ./configs:/web/configs
    environment:
      GONEMAPI_HOST: http://gonemapi
      GONEMAPI_PORT: 8080 # using default internal network
      GONEMAES_API_HOST: http://gonemaes_api
      GONEMAES_API_PORT: 8080 # using default internal network


  gonemaes_server:
    ports:
      - 9200:9200


  gonemaes_api:
    environment:
      GONEMAES_SERVER_HOST: http://gonemaes_server
      GONEMAES_SERVER_PORT: 9200
      # port 8080 by default
    ports:
      - 8081:8080 #port 8081 to avoid reusing 8080, which should be already used by website


  gonemakib:
    environment:
      ELASTICSEARCH_HOSTS: http://gonemaes_server:9200